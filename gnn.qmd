---
title: "GNN: Graph Neural Network"
---

## Full Model

The complete metabolic dynamics:

$$
\frac{dc_i}{dt} = \underbrace{-\lambda_i \cdot (c_i - c_i^{\text{baseline}})}_{\text{homeostasis}} + \underbrace{\sum_{j=1}^{m} S_{ij} \cdot v_j}_{\text{reaction dynamics}}
$$

where the reaction rate $v_j$ depends on aggregation type:

| Aggregation | Rate $v_j$ | Use case |
|-------------|------------|----------|
| Additive | $v_j = k_j \cdot \sum_{k \in \text{sub}(j)} c_k^{s_{kj}}$ | Pure reaction, Homeostasis |
| Multiplicative | $v_j = k_j \cdot \prod_{k \in \text{sub}(j)} c_k^{s_{kj}}$ | Oscillatory (mass-action) |

## The Inverse Problem

**Given:**

- Concentration trajectories $\{c_i(t)\}_{i=1}^{n}$
- Stoichiometric matrix $\mathbf{S}$ (known)

**To learn:**

- Rate constants $k_j$
- Homeostatic parameters $\lambda_i$, $c_i^{\text{baseline}}$

## GNN Parameterization

$$
\frac{dc_i}{dt} = \underbrace{\text{MLP}_{\text{node}}(c_i, a_i)}_{\text{learns } -\lambda_i(c_i - c_i^{\text{baseline}})} + \underbrace{\sum_{j=1}^{m} S_{ij} \cdot k_j \cdot \text{aggr}_{k \in \text{sub}(j)} \text{MLP}_{\text{sub}}(c_k, s_{kj})}_{\text{learns } c_k^{s_{kj}}}
$$

where:
- $a_i \in \mathbb{R}^d$ is a **learnable embedding** for metabolite $i$
- $k_j$ are **learnable rate constants**
- $\text{aggr}$ is sum (additive) or product (multiplicative)

### Learnable Parameters

| Parameter | Type | Purpose |
|-----------|------|---------|
| $a_i$ | Embedding vectors | Per-metabolite identity |
| $k_j$ | Scalars | Per-reaction rate constants |
| $\text{MLP}_{\text{node}}$ | Neural network | Learns $-\lambda_i(c_i - c_i^{\text{baseline}})$ |
| $\text{MLP}_{\text{sub}}$ | Neural network | Learns $c_k^{s_{kj}}$ |

### Configuration

```yaml
graph_model:
  aggr_type: add         # sum (additive) or mul (multiplicative)
  embedding_dim: 2       # dimension of metabolite embeddings a_i
  hidden_dim: 32

training:
  learning_rate_start: 0.001
  freeze_stoichiometry: true   # S given mode
  training_single_type: false  # learn per-metabolite embeddings
```
