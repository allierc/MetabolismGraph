---
title: "MetabolismGraph: Learning Stoichiometric Networks with Graph Neural Networks"
---

## Overview

**MetabolismGraph** is a framework for learning the structure of metabolic networks from concentration dynamics using Graph Neural Networks (GNNs). Given time-series measurements of metabolite concentrations, the model recovers:

1. **Rate constants** $k_j$ — the intrinsic speed of each reaction
2. **Homeostatic parameters** $\lambda_i$, $c_i^{\text{baseline}}$ — metabolite regulation

## The Full Model

The complete metabolic dynamics:

$$
\frac{dc_i}{dt} = \underbrace{-\lambda_i \cdot (c_i - c_i^{\text{baseline}})}_{\text{homeostasis}} + \underbrace{\sum_{j=1}^{m} S_{ij} \cdot v_j}_{\text{reaction dynamics}}
$$

where the reaction rate $v_j$ depends on aggregation type:

| Aggregation | Rate $v_j$ |
|-------------|------------|
| Additive | $v_j = k_j \cdot \sum_{k \in \text{sub}(j)} c_k^{s_{kj}}$ |
| Multiplicative | $v_j = k_j \cdot \prod_{k \in \text{sub}(j)} c_k^{s_{kj}}$ |

See [Model](model.qmd) for detailed equations, diagrams, and model configurations.

## The Inverse Problem

**Given:**

- Concentration trajectories $\{c_i(t)\}_{i=1}^{n}$
- Stoichiometric matrix $\mathbf{S}$ (known from biochemistry)

**To learn:**

- Rate constants $k_j$
- Homeostatic parameters $\lambda_i$, $c_i^{\text{baseline}}$

See [GNN](gnn.qmd) for the GNN parameterization and training configuration.

## Key Features

- **Bipartite graph representation**: metabolites and reactions form a bipartite graph, with stoichiometric coefficients on edges
- **Learnable rate constants**: per-reaction $k_j$ learned via gradient descent
- **Learnable homeostasis**: MLP learns $-\lambda_i(c_i - c_i^{\text{baseline}})$ per metabolite
- **Flexible aggregation**: additive (sum) or multiplicative (product) for different dynamics
- **Metabolite embeddings**: learnable vectors $a_i$ capture per-metabolite identity

## Citation

If you use MetabolismGraph in your research, please cite:

```bibtex
@software{metabolismgraph2025,
  author = {Allier, Cédric},
  title = {MetabolismGraph: Learning Stoichiometric Networks with GNNs},
  year = {2025},
  url = {https://github.com/allierc/MetabolismGraph}
}
```
