---
title: "MetabolismGraph: Learning Stoichiometric Networks with Graph Neural Networks"
---

## Overview

**MetabolismGraph** is a framework for learning the structure of metabolic networks from concentration dynamics using Graph Neural Networks (GNNs). Given time-series measurements of metabolite concentrations, the model jointly recovers:

1. **Stoichiometric coefficients** — which metabolites participate in which reactions, and with what stoichiometry
2. **Reaction rate functions** — how substrate concentrations determine reaction velocities
3. **Rate constants** — the intrinsic speed of each reaction

## The Problem

In metabolic networks, enzymes catalyze reactions that convert substrates into products. The dynamics of metabolite concentrations are governed by the stoichiometric matrix $\mathbf{S}$ and reaction rate functions:

$$\frac{dc_i}{dt} = \sum_j S_{ij} \cdot v_j(\mathbf{c})$$

where:

- $c_i$ is the concentration of metabolite $i$
- $S_{ij}$ is the stoichiometric coefficient (negative for substrates, positive for products)
- $v_j(\mathbf{c})$ is the rate of reaction $j$

The challenge is to recover $\mathbf{S}$ and the rate functions $v_j$ from observed concentration trajectories.

## Key Features

- **Bipartite graph representation**: metabolites and reactions form a bipartite graph, with stoichiometric coefficients on edges
- **Learnable stoichiometry**: the model directly learns the stoichiometric coefficients as edge weights
- **Physics-informed regularization**: L1 sparsity, integer penalties, and mass conservation constraints
- **Interpretable functions**: substrate and rate functions are small MLPs that can be visualized

## Documentation

- [Introduction](introduction.qmd) — Detailed explanation of the model with equations and diagrams
- [Training Guide](training.qmd) — How to train models and tune hyperparameters

## Quick Start

```python
from MetabolismGraph.config import MetabolismGraphConfig
from MetabolismGraph.generators.data_generator import data_generate
from MetabolismGraph.models.graph_trainer import data_train, data_test

# Load configuration
config = MetabolismGraphConfig.from_yaml("config/metabolism.yaml")

# Generate synthetic data
data_generate(config, visualize=True, device="cuda", bSave=True)

# Train the model
data_train(config, erase=True, device="cuda")

# Evaluate
data_test(config, best_model="best", device="cuda")
```

## Citation

If you use MetabolismGraph in your research, please cite:

```bibtex
@software{metabolismgraph2025,
  author = {Allier, Cédric},
  title = {MetabolismGraph: Learning Stoichiometric Networks with GNNs},
  year = {2025},
  url = {https://github.com/allierc/MetabolismGraph}
}
```
